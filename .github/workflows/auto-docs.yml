name: Auto-Update Documentation

on:
  push:
    branches: [master]

jobs:
  update-docs:
    runs-on: ubuntu-latest
    steps:
      - uses: actions/checkout@v4
      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: '20'
      
      - name: Install Gemini CLI
        run: npm install -g @google/gemini-cli
      
      - name: Generate Project Documentation
        env:
          GEMINI_API_KEY: ${{ secrets.GEMINI_API_KEY }}
        run: |
          # Create docs directory if it doesn't exist
          mkdir -p docs
          # Let Gemini CLI analyze the codebase and generate general project docs
          gemini "Analyze this codebase and generate comprehensive project documentation in Markdown format. This appears to be a Hexo static site blog. Include: 1) Project overview and purpose, 2) Technology stack and dependencies, 3) File structure explanation, 4) Build and deployment process, 5) Content management workflow, 6) Development setup instructions. Focus on what this project does and how to work with it." > docs/general.md
      
      - name: Commit updated docs
        run: |
          git config --local user.email "action@github.com"
          git config --local user.name "GitHub Action"
          git add docs/
          git diff --staged --quiet || git commit -m "ðŸ¤– Auto-update project documentation"
          git push
